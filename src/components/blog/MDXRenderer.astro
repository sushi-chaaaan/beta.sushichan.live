---
import type { MarkdownHeading } from "astro"
import type { AstroComponentFactory } from "astro/runtime/server/index.js"

import Link from "@/components/base/Link.astro"
import Toc from "@/components/blog/Toc.astro"
import Image from "@/components/mdx/Image.astro"

type Props = {
  Content: AstroComponentFactory
  remarkPluginFrontmatter?: Record<string, unknown>
} & (
  | {
      headings: MarkdownHeading[]
      tocDepth: 1 | 2 | 3 | 4 | 5 | 6
    }
  | {
      headings?: undefined
      tocDepth?: undefined
    }
)

const { Content, headings, tocDepth } = Astro.props
---

{
  headings && headings.length > 0 && (
    <Toc depth={tocDepth} headings={headings} />
  )
}

<Content components={{ img: Image, a: Link }} />
