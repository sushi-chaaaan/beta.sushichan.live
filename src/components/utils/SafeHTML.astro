---
import type { JSXProps } from "@/utils/@types/jsxProps"

import { sanitizeHTML } from "@/utils/html"

type Props = Omit<JSXProps<"div", "astro">, "set:html"> & {
  __dangerouslyDisableSanitizer?: boolean
  afterSanitize?: (html: string) => string
  as?: "Fragment" | "div" | "span"
  rawHTML: string
}

const {
  __dangerouslyDisableSanitizer = false,
  afterSanitize,
  as = "div",
  rawHTML,
  ...props
} = Astro.props

const safeHTML = __dangerouslyDisableSanitizer ? rawHTML : sanitizeHTML(rawHTML)
const finalHTML = afterSanitize ? afterSanitize(safeHTML) : safeHTML

const Component = as === "Fragment" ? Fragment : as
---

{/* eslint-disable-next-line astro/no-set-html-directive */}
<Component set:html={finalHTML} {...props} />
